<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portofolio ‚Ä¢ iqbalrizanta</title>
  <meta name="description" content="Portofolio sederhana untuk GitHub Pages: profil, proyek, artikel, berita crypto, dan kontak." />
  <meta name="theme-color" content="#0f172a" />
  <style>
    :root{
      --bg:#0b1020; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0; --accent:#22d3ee; --ring:#38bdf8; --border:#1e293b;
    }
    body{margin:0;font:16px/1.6 system-ui,sans-serif;background:linear-gradient(180deg,#0b1020,#0c1226);color:var(--text)}
    .container{max-width:1100px;margin:auto;padding:24px}
    .card{background:rgba(255,255,255,.02);border:1px solid var(--border);border-radius:20px;padding:20px}
    .grid{display:grid;gap:16px}
    .grid-2{grid-template-columns:repeat(2, minmax(0,1fr))}
    .btn{padding:8px 14px;border-radius:12px;border:1px solid var(--border);background:var(--card);cursor:pointer}
    .input{height:40px;border-radius:12px;border:1px solid var(--border);background:#0a1122;color:var(--text);padding:0 12px;outline:0}
    .muted{color:var(--muted)}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    h2{margin-top:28px}
  </style>
</head>
<body>
  <main class="container">
    <!-- CRYPTO NEWS -->
    <section id="crypto-news" class="section">
      <h2>Berita Crypto</h2>
      <div class="row" style="margin-bottom:12px">
        <input id="searchInput" class="input" placeholder="Cari berita..." />
        <button id="refreshBtn" class="btn">üîÑ Refresh</button>
        <button id="toggleAutoBtn" class="btn">‚è±Ô∏è Auto-refresh: OFF</button>
      </div>
      <div id="cryptoContainer" class="grid grid-2"></div>
    </section>

    <!-- CRYPTO PRICES -->
    <section id="crypto-prices" class="section">
      <h2>Harga Crypto Live</h2>
      <div id="priceContainer" class="row"></div>
    </section>
  </main>

  <script>
    // === SCRIPT LAMA ===
    document.getElementById('year').textContent = new Date().getFullYear();

    // tema
    const THEME_KEY = 'pref-theme';
    const btn = document.getElementById('themeBtn');
    function setTheme(mode){
      if(mode==='light'){
        document.documentElement.style.setProperty('--bg','#f8fafc');
        document.documentElement.style.setProperty('--card','#ffffff');
        document.documentElement.style.setProperty('--text','#0f172a');
        document.documentElement.style.setProperty('--muted','#475569');
        document.documentElement.style.setProperty('--border','#e2e8f0');
        document.body.style.background = 'linear-gradient(180deg,#f8fafc,#f1f5f9)';
      }else{
        document.documentElement.style.removeProperty('--bg');
        document.documentElement.style.removeProperty('--card');
        document.documentElement.style.removeProperty('--text');
        document.documentElement.style.removeProperty('--muted');
        document.documentElement.style.removeProperty('--border');
        document.body.style.background = 'linear-gradient(180deg,#0b1020,#0c1226)';
      }
      localStorage.setItem(THEME_KEY, mode);
    }
    const saved = localStorage.getItem(THEME_KEY);
    if(saved) setTheme(saved);
    btn.addEventListener('click',()=>{setTheme(localStorage.getItem(THEME_KEY) === 'light' ? 'dark' : 'light')});

    // fetch berita crypto (versi lama)
    async function loadCryptoNews(){
      const container = document.getElementById('cryptoContainer');
      container.innerHTML = '<p class="muted">Memuat berita crypto...</p>';
      try{
        const res = await fetch('https://min-api.cryptocompare.com/data/v2/news/?lang=EN');
        const data = await res.json();
        container.innerHTML = '';
        data.Data.slice(0,4).forEach(item=>{
          const card = document.createElement('article');
          card.className = 'card hvr';
          card.innerHTML = `
            <h3>${item.title}</h3>
            <p class="muted">${item.body.slice(0,100)}...</p>
            <a class="btn" href="${item.url}" target="_blank">Baca</a>
          `;
          container.appendChild(card);
        });
      }catch(e){
        container.innerHTML = '<p class="muted">Gagal memuat berita.</p>';
      }
    }
    loadCryptoNews();

    // === FITUR BARU ===
    const containerNews = document.getElementById('cryptoContainer');
    const searchInput = document.getElementById('searchInput');
    const refreshBtn = document.getElementById('refreshBtn');
    const toggleAutoBtn = document.getElementById('toggleAutoBtn');
    const priceContainer = document.getElementById('priceContainer');

    let newsData = [];
    let autoRefresh = false;
    let intervalId = null;

    // fetch berita crypto (versi baru untuk pencarian)
    async function loadCryptoNewsExtended(){
      containerNews.innerHTML = '<p class="muted">Memuat berita crypto...</p>';
      try{
        const res = await fetch('https://min-api.cryptocompare.com/data/v2/news/?lang=EN');
        const data = await res.json();
        newsData = data.Data.slice(0, 10);
        renderNews(newsData);
      }catch(e){
        containerNews.innerHTML = '<p class="muted">Gagal memuat berita.</p>';
      }
    }

    function renderNews(list){
      containerNews.innerHTML = '';
      if(list.length === 0){
        containerNews.innerHTML = '<p class="muted">Tidak ada berita ditemukan.</p>';
        return;
      }
      list.forEach(item=>{
        const card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = `
          <h3>${item.title}</h3>
          <p class="muted">${item.body.slice(0,120)}...</p>
          <a class="btn" href="${item.url}" target="_blank">Baca</a>
        `;
        containerNews.appendChild(card);
      });
    }

    // pencarian berita
    searchInput.addEventListener('input', e=>{
      const q = e.target.value.toLowerCase();
      const filtered = newsData.filter(n=>n.title.toLowerCase().includes(q));
      renderNews(filtered);
    });

    // tombol refresh
    refreshBtn.addEventListener('click', loadCryptoNewsExtended);

    // auto refresh
    toggleAutoBtn.addEventListener('click', ()=>{
      autoRefresh = !autoRefresh;
      toggleAutoBtn.textContent = autoRefresh ? "‚è±Ô∏è Auto-refresh: ON" : "‚è±Ô∏è Auto-refresh: OFF";
      if(autoRefresh){
        intervalId = setInterval(loadCryptoNewsExtended, 5*60*1000);
      }else{
        clearInterval(intervalId);
      }
    });

    // harga crypto live
    async function loadPrices(){
      try{
        const res = await fetch("https://min-api.cryptocompare.com/data/pricemulti?fsyms=BTC,ETH,DOGE&tsyms=USD,IDR");
        const data = await res.json();
        priceContainer.innerHTML = '';
        Object.keys(data).forEach(symbol=>{
          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <strong>${symbol}</strong><br>
            USD: $${data[symbol].USD.toLocaleString()}<br>
            IDR: Rp${data[symbol].IDR.toLocaleString()}
          `;
          priceContainer.appendChild(card);
        });
      }catch(e){
        priceContainer.innerHTML = '<p class="muted">Gagal memuat harga.</p>';
      }
    }

    // load awal
    loadCryptoNewsExtended();
    loadPrices();
    setInterval(loadPrices, 60000); // update harga tiap 1 menit
  </script>
</body>
</html>
